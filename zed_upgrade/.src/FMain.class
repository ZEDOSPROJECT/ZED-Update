' Gambas class file

Public ActualVersion As String = ""
Public NewVersion As String = ""

Public Sub Form_Open()
  Me.Center()
End


Public Sub Button2_Click()

  Exec ["killall", "updater.sh"]
  Quit

End

Public Sub Button1_Click()

  Me.Hide()
  ActualVersion = File.Load("/etc/zed_updater/version")
  checker.Enabled = True
  If System.User.Name <> "root" Then
    Exec ["gksu", "'/etc/zed_updater/di.sh'", "-m 'Insert your password to install updates'"]
  Else
    Exec ["/etc/zed_updater/di.sh"]
  Endif

End

Public Sub checker_Timer()
    NewVersion = File.Load("/etc/zed_updater/version")
    If NewVersion <> ActualVersion Then
      If Not Exist("/tmp/update.tar.gz") Then
        frm_install.Hide()
        Print Message("ZED OS is Updated", "OK")
        Me.Close()
      Endif
    Else
      If frm_install.Visible = False Then
        frm_install.Show()
      Endif
    Endif

End
